<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Databrary Guide - Databrary 2.0</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../more-information/references.html" rel="next">
<link href="../more-information/software.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../include/css/style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../more-information/more-information.html">More information</a></li><li class="breadcrumb-item"><a href="../more-information/db-2.0.html">Databrary 2.0</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Databrary Guide</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/databrary/guide/tree/main/src/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../background/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About Databrary</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background/who-why.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Who and why?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../background/ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ethics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-institutions/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">For Institutions</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">For Investigators</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Background</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/requesting-access.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Requesting access</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/onboarding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Onboarding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/managing-people.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Managing people</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/create-new-volume.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating a new volume</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/edit-existing-volume.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Editing a volume</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/reusing-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reusing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-investigators/best-practices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Best practices</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">For Affiliates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-affiliates/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Background</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-affiliates/requesting-access-affiliates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Requesting access</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-affiliates/onboarding-affiliates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Onboarding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-affiliates/creating-new-volume-affiliates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating a new volume</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-affiliates/edit-existing-volume-affiliates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Edit a Volume</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../for-affiliates/reusing-data-affiliates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reusing data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../more-information/more-information.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">More information</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../more-information/faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequently Asked Questions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../more-information/definitions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Definitions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../more-information/software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../more-information/db-2.0.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Databrary 2.0</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../more-information/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/access_agreement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Formal Access Agreement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/sharing-release-participants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Data Sharing Release: Participants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/sharing-release-staff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data Sharing Release: Staff</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/sharing-release-script.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Sample Release Script</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/post-visit-release-email.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Post-visit release email</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/irb-application-template.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">IRB application template</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/privacy_policy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Databrary Privacy Policy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/terms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Terms and Conditions of Use</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/participant_info.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Participant Bill of Rights</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/grants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Grants</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#technology-stack" id="toc-technology-stack" class="nav-link active" data-scroll-target="#technology-stack">Technology stack</a>
  <ul>
  <li><a href="#frontend" id="toc-frontend" class="nav-link" data-scroll-target="#frontend">Frontend</a></li>
  <li><a href="#backend" id="toc-backend" class="nav-link" data-scroll-target="#backend">Backend</a></li>
  </ul></li>
  <li><a href="#requirements" id="toc-requirements" class="nav-link" data-scroll-target="#requirements">Requirements</a>
  <ul>
  <li><a href="#schema" id="toc-schema" class="nav-link" data-scroll-target="#schema">Schema</a></li>
  <li><a href="#user-access-privileges" id="toc-user-access-privileges" class="nav-link" data-scroll-target="#user-access-privileges">User Access Privileges</a>
  <ul class="collapse">
  <li><a href="#affiliate-access-to-an-authorized-investigators-data" id="toc-affiliate-access-to-an-authorized-investigators-data" class="nav-link" data-scroll-target="#affiliate-access-to-an-authorized-investigators-data"><em>Affiliate access to an </em>Authorized Investigator*’s data</a></li>
  </ul></li>
  <li><a href="#registration-workflow" id="toc-registration-workflow" class="nav-link" data-scroll-target="#registration-workflow">Registration workflow</a>
  <ul class="collapse">
  <li><a href="#create-account" id="toc-create-account" class="nav-link" data-scroll-target="#create-account">Create Account</a></li>
  <li><a href="#get-started" id="toc-get-started" class="nav-link" data-scroll-target="#get-started">Get Started</a></li>
  <li><a href="#confirm-email" id="toc-confirm-email" class="nav-link" data-scroll-target="#confirm-email">Confirm email</a></li>
  <li><a href="#set-password" id="toc-set-password" class="nav-link" data-scroll-target="#set-password">Set Password</a></li>
  <li><a href="#request-authorization" id="toc-request-authorization" class="nav-link" data-scroll-target="#request-authorization">Request Authorization</a></li>
  </ul></li>
  <li><a href="#volume-interface" id="toc-volume-interface" class="nav-link" data-scroll-target="#volume-interface">Volume interface</a></li>
  <li><a href="#sessions-interface" id="toc-sessions-interface" class="nav-link" data-scroll-target="#sessions-interface">Sessions interface</a></li>
  </ul></li>
  <li><a href="#scoping" id="toc-scoping" class="nav-link" data-scroll-target="#scoping">Scoping</a>
  <ul>
  <li><a href="#roadmap-2.0" id="toc-roadmap-2.0" class="nav-link" data-scroll-target="#roadmap-2.0">Roadmap (&gt;2.0)</a>
  <ul class="collapse">
  <li><a href="#support-for-open-data-schemas" id="toc-support-for-open-data-schemas" class="nav-link" data-scroll-target="#support-for-open-data-schemas">Support for open data schemas</a></li>
  <li><a href="#improved-search-and-filtering" id="toc-improved-search-and-filtering" class="nav-link" data-scroll-target="#improved-search-and-filtering">Improved search and filtering</a></li>
  <li><a href="#virtual-volumes-or-custom-collections" id="toc-virtual-volumes-or-custom-collections" class="nav-link" data-scroll-target="#virtual-volumes-or-custom-collections">“Virtual volumes” or custom collections</a></li>
  <li><a href="#workspaces" id="toc-workspaces" class="nav-link" data-scroll-target="#workspaces">Workspaces</a></li>
  <li><a href="#expanding-scriptable-access" id="toc-expanding-scriptable-access" class="nav-link" data-scroll-target="#expanding-scriptable-access">Expanding scriptable access</a></li>
  <li><a href="#administrative-upgrades" id="toc-administrative-upgrades" class="nav-link" data-scroll-target="#administrative-upgrades">Administrative upgrades</a></li>
  <li><a href="#version-control" id="toc-version-control" class="nav-link" data-scroll-target="#version-control">Version control</a></li>
  <li><a href="#private-volumes-for-peer-review" id="toc-private-volumes-for-peer-review" class="nav-link" data-scroll-target="#private-volumes-for-peer-review">Private volumes for peer review</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/databrary/guide/edit/main/src/more-information/db-2.0.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/databrary/guide/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../more-information/more-information.html">More information</a></li><li class="breadcrumb-item"><a href="../more-information/db-2.0.html">Databrary 2.0</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Databrary 2.0</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>As of April 2024, Databrary has begun a rewrite led by <a href="https://montrosesoftware.com">Montrose Software</a>.</p>
<p>We are making use of two (currently private) repositories for the rewrite:</p>
<ul>
<li><a href="https://github.com/databrary/frontend_2.0">frontend_2.0</a></li>
<li><a href="https://github.com/databrary/backend_2.0">backend_2.0</a></li>
</ul>
<p>Once internal licensing discussions have concluded, we may make the repositories public.</p>
<section id="technology-stack" class="level2">
<h2 class="anchored" data-anchor-id="technology-stack">Technology stack</h2>
<section id="frontend" class="level3">
<h3 class="anchored" data-anchor-id="frontend">Frontend</h3>
<ul>
<li>TypeScript</li>
<li>ReactJS</li>
<li>SCSS</li>
<li>Webpack and npm</li>
</ul>
</section>
<section id="backend" class="level3">
<h3 class="anchored" data-anchor-id="backend">Backend</h3>
<ul>
<li>Python</li>
<li>Django</li>
<li>PostgreSQL</li>
<li>FFmpeg/Elastic Transcoder</li>
<li>Docker</li>
</ul>
</section>
</section>
<section id="requirements" class="level2">
<h2 class="anchored" data-anchor-id="requirements">Requirements</h2>
<p>This section provides additional information about the requirements for specific aspects of the Databrary 2.0 application.</p>
<section id="schema" class="level3">
<h3 class="anchored" data-anchor-id="schema">Schema</h3>
<p>The Databrary 1.0 schema can be found <a href="https://github.com/databrary/databrary/tree/master/schema">here</a>.</p>
<p>Montrose <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> recommends that we implement separate tables for <code>individuals</code> and <code>institutions</code>. These entities are combined into a single <code>party</code> table in the current schema.</p>
</section>
<section id="user-access-privileges" class="level3">
<h3 class="anchored" data-anchor-id="user-access-privileges">User Access Privileges</h3>
<section id="affiliate-access-to-an-authorized-investigators-data" class="level4">
<h4 class="anchored" data-anchor-id="affiliate-access-to-an-authorized-investigators-data"><em>Affiliate access to an </em>Authorized Investigator*’s data</h4>
<p>A user may be given privileges to a <em>Volume</em> by an <em>Authorized Investigator</em>.</p>
<ul>
<li>(<span class="remove-feature">remove</span>) <em>No access</em> (default)
<ul>
<li>This is redundant for the UI. Remove it there. Retain for backend.</li>
</ul></li>
<li>(<span class="remove-feature">remove</span>) <em>View and access only public data</em> (Level visible only to Super User; eliminate.)</li>
<li>(<span class="remove-feature">remove</span>) <em>View and access only shared data</em> (Level visible only to Super User; eliminate.)</li>
<li><em>Read-only access</em></li>
<li><em>Read/write access</em></li>
<li><em>Manager</em>
<ul>
<li>Read, write, create <strong>Private</strong> volumes ((<span class="add-feature">new</span>) with supervising <em>Authorized Investigator as the owner</em>)</li>
<li>(<span class="remove-feature">remove</span>) Manager ability to change volume access (change sharing)</li>
<li>(<span class="remove-feature">remove</span>) Manager ability to extend access to <em>Affiliates</em></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Per 2024-05-08 meeting with Montrose, we are likely to implement separate categories for Affiliate privileges “Read”, “Write”, and “Create” and enable various combinations of these, such as “Create” only or “Create” plus “Read” but not write.</p>
</div>
</div>
</section>
</section>
<section id="registration-workflow" class="level3">
<h3 class="anchored" data-anchor-id="registration-workflow">Registration workflow</h3>
<p>Registration consists of multiple steps. The following shows requested modifications to the Databrary 1.0 workflow.</p>
<section id="create-account" class="level4">
<h4 class="anchored" data-anchor-id="create-account">Create Account</h4>
<p>The reference page for the Databrary 1.0 registration process is here:</p>
<p><img src="../include/img/db-create-account.JPG" class="img-fluid"></p>
<p>Fields are as follows:</p>
<ul>
<li><em>First and Middle Name</em> (required)</li>
<li><em>Last Name</em> (required)</li>
<li><em>Email</em> (required)
<ul>
<li>Add instruction text that specifies an official institutional email must be used for this field (e.g., @psu.edu).</li>
<li>Implement email validation (against existing database of valid institutional email, flag @gmail.com, etc.)</li>
<li>Permit free-text email if validation fails</li>
</ul></li>
<li><em>Affiliation</em> (required)
<ul>
<li>Type-ahead search of existing database of authorized Institutions.</li>
<li>If no matching institution exists, the user can enter a new institution, but should be notified.</li>
<li>Change label to <em>Institutional Affiliation</em>.</li>
</ul></li>
</ul>
</section>
<section id="get-started" class="level4">
<h4 class="anchored" data-anchor-id="get-started">Get Started</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../include/img/db-get-started.JPG" class="img-fluid figure-img"></p>
<figcaption>Get Started panel</figcaption>
</figure>
</div>
<ul>
<li>Require user to confirm that they have read and agree to the Databrary Access Agreement.</li>
<li>Link to the Terms and Conditions of Use.</li>
</ul>
</section>
<section id="confirm-email" class="level4">
<h4 class="anchored" data-anchor-id="confirm-email">Confirm email</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../include/img/db-confirm-email.JPG" class="img-fluid figure-img"></p>
<figcaption>Confirm Email panel</figcaption>
</figure>
</div>
</section>
<section id="set-password" class="level4">
<h4 class="anchored" data-anchor-id="set-password">Set Password</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../include/img/db-set-password.JPG" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
<figcaption>Databrary Set Password panel</figcaption>
</figure>
</div>
<ul>
<li>Require strong password (increase number of required characters from 7 to 14 characters. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
<li>Validate password to ensure that password is strong</li>
</ul>
</section>
<section id="request-authorization" class="level4">
<h4 class="anchored" data-anchor-id="request-authorization">Request Authorization</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../include/img/db-request-authorization.JPG" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
<figcaption>Databrary Request Authorization panel</figcaption>
</figure>
</div>
<ul>
<li>Add <em>new</em> drop-down menu for <em>new</em> <code>user_position</code> field that requires users to enter their position at their institution. The acceptable values for this field are as follows:
<ul>
<li>Faculty/Independent Researcher</li>
<li>Student</li>
<li>Staff</li>
<li>Other</li>
</ul></li>
<li>If <code>user_position</code> is in {‘Student’, ‘Staff’, ‘Other’}
<ul>
<li>Show <code>research_sponsor</code> text field
<ul>
<li>Add instruction text asking user to type the name of the person who is their research sponsor or supervisor; the entered text should use look-ahead search to match to Authorized Investigators currently active on Databrary at the user’s specified institution.</li>
<li>If the search succeeds, the user can select the name of their research sponsor.
<ul>
<li>Generate a request for authorization from the current user to the research sponsor; cc the current user.</li>
<li>Provide the user feedback that this request has been sent.</li>
</ul></li>
<li>If the search fails, the user can enter the name of their research sponsor, but warning text appears: “This research sponsor cannot be found.”
<ul>
<li>Ask the user to enter their research sponsor’s institutional email address.
<ul>
<li>Validate that address as above.</li>
</ul></li>
<li>Confirm that the user wants Databrary to send a request to register email to the user’s research sponsor.
<ul>
<li>If yes, send the email to the research sponsor and cc the current user.</li>
<li><strong>TO-DO</strong>: Draft this email.</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li>If <code>user_position</code> is “Faculty/Independent Researcher”
<ul>
<li>Show <em>new</em> text field <code>user_institutional_profile</code> and ask user to enter the URL for their institutional profile page.
<ul>
<li>Add explanatory text: “Databrary requires that we confirm a new user is eligible for Authorized Investigator status. Please provide a URL to your personal profile page at your institution to assist us in verifying your status.”</li>
</ul></li>
<li>If user’s institution is <em>not</em> in Databrary’s database of authorizing institutions…
<ul>
<li>Ask user to enter information into two <em>new</em> (optional) text fields: <code>institution_authorizing_official_full_name</code> for the full name of the institution’s authorizing official and <code>institution_authorizing_official_email</code> for that person’s email.</li>
</ul></li>
<li>If user’s institution is in the Databrary database of authorizing institutions…
<ul>
<li>Show text saying “<code>institution</code> has active users on Databrary. Here is a link to other users from <code>institution</code> on Databrary: <link-to-institution-page-with-active-users>. Our staff will work with you and your institution to expedite your authorization.”</link-to-institution-page-with-active-users></li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="volume-interface" class="level3">
<h3 class="anchored" data-anchor-id="volume-interface">Volume interface</h3>
<ul>
<li>(<span class="add-feature">new</span>): Create bibliographic contributor field. Allow sorting of authors.</li>
<li>(<span class="add-feature">new</span>): New volumes have a <strong>single</strong> owner who must be an Authorized Investigator.</li>
</ul>
<p><img src="img/manage-volume-overview.png" class="img-fluid"></p>
<ul>
<li>(<span class="remove-feature">remove</span>): “Does this valume correspond to a published paper…” and related look up published paper or resource; complete reference info. Will enter linked resources in Add Links tab below.</li>
<li>(<span class="remove-feature">remove</span>): “Add keywords” interface (push to &gt;2.0)</li>
<li>(<span class="future-feature">future</span>): Pull keywords from related/linked articles</li>
</ul>
<p><img src="img/volume-manage-access.png" class="img-fluid"></p>
<ul>
<li>(<span class="change-feature">change</span>): Default Volume access to Private</li>
<li>(<span class="change-feature">change</span>): Separate (single) volume owner from Collaborators. Allow transfer of ownership here.</li>
<li>(<span class="remove-feature">remove</span>): “Extend access to … affiliates” checkbox and related functionality.</li>
<li>(<span class="remove-feature">remove</span>): “Investigator (read/write/share)” option for collaborators.</li>
<li>(<span class="change-feature">change</span>): Make “Read only” default access level for all added Collaborators.</li>
<li>(<span class="discuss-feature">discuss</span>): Add expiration date for access to volume for all collaborators.</li>
</ul>
<p><img src="img/manage-volume-design-ss.png" class="img-fluid"></p>
<ul>
<li>(<span class="discuss-feature">discuss</span>): How to simplify</li>
</ul>
<p><img src="img/manage-volume-enter-data.png" class="img-fluid"></p>
<ul>
<li>(<span class="discuss-feature">discuss</span>): How to simplify
<ul>
<li>2024-08-06: <em>Required</em> variables:
<ul>
<li>File name</li>
<li>Sharing release level</li>
<li>File type (from extension)</li>
</ul></li>
</ul></li>
</ul>
<p><img src="img/manage-volume-add-links.png" class="img-fluid"></p>
<ul>
<li>(<span class="change-feature">change</span>): “Enter title or paper/dataset citation”</li>
<li>(<span class="future-feature">future</span>): Way to search Databrary for related datasets.</li>
</ul>
<p><img src="img/manage-volume-list-funding.png" class="img-fluid"></p>
<ul>
<li>(<span class="change-feature">change</span>): Lookup existing funder, but permit user-entered value(s)</li>
</ul>
<p><img src="img/montrose-vol-1777.png" class="img-fluid"></p>
<ul>
<li>(<span class="change-feature">change</span>): Merge FILE RELEASE LEVELS data with “added on”, “sessions”, “participants” panel</li>
<li>(<span class="change-feature">change</span>): “HOW TO CITE” field has user editable authors, Databrary specific info is added by the system</li>
<li>(<span class="add-feature">new</span>): OWNER sub-panel</li>
<li>(<span class="change-feature">change</span>): Fix column size so that long names and affiliations aren’t cut-off</li>
</ul>
<p><img src="img/montrose-volume-1777-lower.png" class="img-fluid"></p>
<ul>
<li>(<span class="remove-feature">remove</span>): “Create highlight” button and associated workflow. Re-implement in &gt;2.0</li>
<li>(<span class="remove-feature">remove</span>): “Show saved display mode” dropdown and associated workflow. May re-implement some portion in &gt;2.0.</li>
<li>(<span class="remove-feature">remove</span>): “Show summary” functionality. May re-implement some portion in &gt;2.0.</li>
<li>(<span class="remove-feature">remove</span>): <strong>Save current display mode</strong> functionality.</li>
<li>(<span class="add-feature">new</span>): Separate interface for Materials</li>
<li>(<span class="discuss-feature">discuss</span>): Simpler tablular interface for spreadsheet display?</li>
</ul>
<p><img src="img/montrose-volume-1777-bottom.png" class="img-fluid"></p>
<ul>
<li>(<span class="remove-feature">remove</span>): Comments. Consider re-implementing in &gt;2.0</li>
</ul>
</section>
<section id="sessions-interface" class="level3">
<h3 class="anchored" data-anchor-id="sessions-interface">Sessions interface</h3>
<p><img src="img/montrose-volume-1777-slot-73286.png" class="img-fluid"></p>
<ul>
<li>(<span class="remove-feature">remove</span>): Keywords and Tags.</li>
<li>(<span class="remove-feature">remove</span>): Bars that summarize spreadsheet metadata values.</li>
<li>(<span class="remove-feature">remove</span>): File names sort by timestamp uploaded.</li>
<li>(<span class="remove-feature">remove</span>): Video editing within viewer to create highlights.</li>
<li>(<span class="discuss-feature">discuss</span>): Better interface layout for previewing videos.
<ul>
<li>2024-08-06
<ul>
<li>(<span class="change-feature">change</span>): Create pop-up window for previewing video/audio</li>
<li>(<span class="discuss-feature">discuss</span>): Could pop-up viewer allow other file-type “previews”, e.g.&nbsp;PDF, docx, txt? Or push to later timepoint.</li>
</ul></li>
</ul></li>
<li>(<span class="change-feature">change</span>): Make “set as highlight” feature more visible. This applies to a file.</li>
<li>(<span class="change-feature">change</span>): Simpler tablular interface viewing files, release level, highlight status, etc.
<ul>
<li>Columns include: File name, sharing release level, file type, size, last modified (optional)</li>
<li>(<span class="discuss-feature">discuss</span>): Move button to downloading single file to table</li>
</ul></li>
</ul>
<p><img src="img/volume-339-slot-16961.png" id="fig-vol-339-slot-1681" class="img-fluid" alt="Timeline from https://nyu.databrary.org/volume/339/slot/16961/-"> - (<span class="remove-feature">remove</span>): Timeline.</p>
<p><img src="img/session-download-all-files-as-zip.png" class="img-fluid"></p>
<ul>
<li>(<span class="discuss-feature">discuss</span>): “Download all files as zip”. With large sessions and/or large files, the zip files are also large and require application resources to create. Are there any third party libraries we could use that would off-load this process? <em>Note:</em> This problem is larger with the “Download all folders as zip” function on the volumes page.</li>
</ul>
</section>
</section>
<section id="scoping" class="level2">
<h2 class="anchored" data-anchor-id="scoping">Scoping</h2>
<p>While the core of Databrary 1.0 is understood and will be replicated in Databrary 2.0, some questions will be explored that relate to new features:</p>
<ul>
<li>(<span class="discuss-feature">discuss</span>): Should video and audio transcoding be automatic or optional; if optional, how can transcoding be triggered?</li>
<li>(<span class="discuss-feature">discuss</span>): (What features of the existing session/slot spreadsheet interface for managing and visualizing demographic data can be implemented easily and at minimal cost using existing libraries?</li>
<li><del>Can two-factor authentication be added? If so, at what cost?</del><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></li>
<li>(<span class="discuss-feature">discuss</span>): Can per-institution (across users and projects), per-user (across projects) or per-project storage quotas be implemented? Can warnings be generated when storage amounts are nearing quotas? How could Super Users manage user requests to increase quotas?</li>
<li>(<span class="discuss-feature">discuss</span>): Can a more informative administrative console be developed with by-volume, usage, and storage metrics, including shared vs.&nbsp;unshared data? If so, at what cost?</li>
<li>(<span class="discuss-feature">discuss</span>): Volume access expires after a user-defined date that is no longer than one year from the date of the last update.</li>
</ul>
<section id="roadmap-2.0" class="level3">
<h3 class="anchored" data-anchor-id="roadmap-2.0">Roadmap (&gt;2.0)</h3>
<section id="support-for-open-data-schemas" class="level4">
<h4 class="anchored" data-anchor-id="support-for-open-data-schemas">Support for open data schemas</h4>
<ul>
<li>Databrary should eventually support standard schemas wherever practical, specifically in the <a href="https://json-ld.org">JSON-LD</a> format. These should use <a href="https://schema.org">Schema.org</a> properties.</li>
<li>Examples of properties that seem relevant to Databrary include:
<ul>
<li><a href="https://schema.org/Person"><em>Person</em></a></li>
<li><a href="https://schema.org/CreativeWork"><em>Creative Work</em></a>
<ul>
<li><a href="https://schema.org/VideoObject">VideoObject</a></li>
</ul></li>
<li><a href="https://schema.org/Intangible"><em>Event</em></a>
<ul>
<li>For a data collection session or change in status on the site.</li>
</ul></li>
<li><a href="https://schema.org/Place"><em>Place</em></a></li>
<li><a href="https://schema.org/Intangible"><em>Intangible</em></a></li>
<li>The set of <a href="https://schema.org/DataType">Data Types</a></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>These examples are not exhaustive.</p>
</div>
</div>
<p>Databrary should also support <a href="https://cde.nlm.nih.gov/home">NIH Common Data Elements (CDEs)</a>, especially for “spreadsheet” data elements.</p>
<ul>
<li>Examples of CDE properties of a <a href="https://schema.org/Person"><em>Person</em></a>
<ul>
<li><em>Gender</em>: <a href="https://cde.nlm.nih.gov/formView?tinyId=vx35JcbgJI" class="uri">https://cde.nlm.nih.gov/formView?tinyId=vx35JcbgJI</a></li>
<li><em>Sex at Birth</em>: <a href="https://cde.nlm.nih.gov/deView?tinyId=rGEh0ckdmr" class="uri">https://cde.nlm.nih.gov/deView?tinyId=rGEh0ckdmr</a></li>
<li><em>Race</em>: <a href="https://cde.nlm.nih.gov/deView?tinyId=Fakc6Jy2x" class="uri">https://cde.nlm.nih.gov/deView?tinyId=Fakc6Jy2x</a></li>
<li><em>Race/Ethnicity Self-Identification</em>: <a href="https://cde.nlm.nih.gov/deView?tinyId=LakF0YkywC" class="uri">https://cde.nlm.nih.gov/deView?tinyId=LakF0YkywC</a></li>
<li><em>Ethnicity</em>: <a href="https://cde.nlm.nih.gov/deView?tinyId=PtRlg7yLP_" class="uri">https://cde.nlm.nih.gov/deView?tinyId=PtRlg7yLP_</a></li>
<li><em>Disabilities</em>: <a href="https://cde.nlm.nih.gov/deView?tinyId=0md12WGtZXE" class="uri">https://cde.nlm.nih.gov/deView?tinyId=0md12WGtZXE</a></li>
<li><em>Birth date</em>: <a href="https://cde.nlm.nih.gov/deView?tinyId=X1mJv5j3jx" class="uri">https://cde.nlm.nih.gov/deView?tinyId=X1mJv5j3jx</a>.</li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are a set of CDEs that NIH endorses. These should be the highest priority.</p>
</div>
</div>
</section>
<section id="improved-search-and-filtering" class="level4">
<h4 class="anchored" data-anchor-id="improved-search-and-filtering">Improved search and filtering</h4>
<p>Ideas from HNDS-I 2024 proposal:</p>
<ol type="1">
<li>Broader set of demographic characteristics.</li>
<li>Index other text documents in materials folders.</li>
</ol>
<section id="index-annotation-files-return-segments" class="level5">
<h5 class="anchored" data-anchor-id="index-annotation-files-return-segments">Index annotation files, return segments</h5>
<blockquote class="blockquote">
<p>“Building on this foundation, we will upgrade Databrary to support searching within annotation files linked to videos that tag specific behaviors, utterances, or contexts, starting with the most popular annotation file formats stored on Databrary (Datavyu and CHAT)”</p>
</blockquote>
<p>— HNDS-I proposal.</p>
</section>
</section>
<section id="virtual-volumes-or-custom-collections" class="level4">
<h4 class="anchored" data-anchor-id="virtual-volumes-or-custom-collections">“Virtual volumes” or custom collections</h4>
<blockquote class="blockquote">
<p>To capitalize on enhanced search and filtering and ease data reuse, users must be able to create their own custom collections of video files, video segments, annotations, and other data derived from multiple, primary datasets. The custom collections or “virtual datasets” will link to but not copy parent datasets and their associated metadata.</p>
</blockquote>
<p>— HNDS-I proposal.</p>
</section>
<section id="workspaces" class="level4">
<h4 class="anchored" data-anchor-id="workspaces">Workspaces</h4>
<blockquote class="blockquote">
<p>…We will implement private, flexible, temporary workspaces for datasets that act like folders in cloud storage. Unlike other forms of cloud storage that provide only a temporary home for research data, Databrary’s workspaces will provide a permanent and flexible home that is just a button press away from being made accessible to the broader research community.</p>
</blockquote>
<p>– HNDS-I proposal.</p>
</section>
<section id="expanding-scriptable-access" class="level4">
<h4 class="anchored" data-anchor-id="expanding-scriptable-access">Expanding scriptable access</h4>
<blockquote class="blockquote">
<p>…We will build on the free, open-source, R package, <em>databraryr</em>, that PI Gilmore developed with NSF support and openly released to the research community. Databraryr wraps Databrary API calls into commands that are useful to researchers who want to download shared data from Databrary. We will add data uploading capabilities to the R package to support Aim 3, develop and publish a parallel Python package, <em>databrarypy</em>.</p>
</blockquote>
<p>– HNDS-I proposal.</p>
</section>
<section id="administrative-upgrades" class="level4">
<h4 class="anchored" data-anchor-id="administrative-upgrades">Administrative upgrades</h4>
<ul>
<li>Quotas on per-user, per-institution storage footprints.</li>
<li>Infrastructure for managing subscriptions, curation assistance, data deposit fees.</li>
<li>Links to institutional admin panel functions; data footprint, etc.</li>
</ul>
</section>
<section id="version-control" class="level4">
<h4 class="anchored" data-anchor-id="version-control">Version control</h4>
<p><a href="https://zenodo.org">Zenodo</a> and <a href="https://osf.io">OSF</a> implement this.</p>
</section>
<section id="private-volumes-for-peer-review" class="level4">
<h4 class="anchored" data-anchor-id="private-volumes-for-peer-review">Private volumes for peer review</h4>
<p><a href="https://osf.io">OSF</a> implements this.</p>


</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>2024-04-17 meeting<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://www.nyu.edu/life/information-technology/safe-computing/protect-your-privacy/secure-your-passwords.html<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>2024-04-17 determined that 2FA via email and SMS should be implemented.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../more-information/software.html" class="pagination-link  aria-label=" software"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Software</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../more-information/references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/databrary/guide/edit/main/src/more-information/db-2.0.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/databrary/guide/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>